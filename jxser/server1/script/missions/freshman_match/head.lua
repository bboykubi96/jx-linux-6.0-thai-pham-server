IncludeLib("FILESYS") 
IncludeLib("RELAYLADDER") 
IncludeLib("TITLE") 
IncludeLib("ITEM") 
Include( "\\script\\missions\\freshman_match\\freshman_data.lua" )
Include( "\\script\\missions\\freshman_match\\freshman_info.lua" )

function transtoplace() 

if (GetLastFactionNumber() == -1) then 
Say("Minh chÒ v‚ l©m c„ l÷nh # chÿ c„ thÀp Æπi m´n ph∏i ng≠Íi mÌi c„ th” tham gia Æπi hÈi v‚ l©m , ng≠¨i kh´ng m´n kh´ng ph∏i , kh´ng th” tham gia . gia nhÀp thÀp Æπi m´n ph∏i sau mÌi c„ th” tham gia tranh tµi !", 0) 
return 
else 
if(GetLastFactionNumber() == 0) then 
NewWorld(CP_MAPTAB[1][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  Thi’u L©m 
elseif (GetLastFactionNumber() == 1) then 
NewWorld(CP_MAPTAB[2][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  Thi™n v≠¨ng 
elseif (GetLastFactionNumber() == 2) then 
NewWorld(CP_MAPTAB[3][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  ß≠Íng m´n 
elseif (GetLastFactionNumber() == 3) then 
NewWorld(CP_MAPTAB[4][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  n®m ÆÈc 
elseif (GetLastFactionNumber() == 4) then 
NewWorld(CP_MAPTAB[5][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  Nga Mi 
elseif (GetLastFactionNumber() == 5) then 
NewWorld(CP_MAPTAB[6][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  thÛy kh„i 
elseif (GetLastFactionNumber() == 6) then 
NewWorld(CP_MAPTAB[7][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  C∏i Bang 
elseif (GetLastFactionNumber() == 7) then 
NewWorld(CP_MAPTAB[8][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  ngµy nh…n 
elseif (GetLastFactionNumber() == 8) then 
NewWorld(CP_MAPTAB[9][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  V‚ ß≠¨ng 
elseif (GetLastFactionNumber() == 9) then 
NewWorld(CP_MAPTAB[10][1], CP_MAPPOS_IN[1], CP_MAPPOS_IN[2])-- script viet hoa By http://tranhba.com  C´n L´n 
end 
Msg2Player("Ng≠¨i Æ∑ ti’n vµo v‚ l©m t©n tÛ cuÈc so tµi trµng " ) 
end 
end 

-- script viet hoa By http://tranhba.com  b∂ng x’p hπng ID muËn ÆÊi -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  
function checkmap(flag) 
local mapid = SubWorldIdx2ID(SubWorld) 
local ladder = 0 
if (mapid == 397 or mapid == 396) then 
mapname = " Thi’u L©m " 
ladder = 10131 
elseif (mapid == 399 or mapid == 398) then 
mapname = " Thi™n v≠¨ng " 
ladder = 10132 
elseif (mapid == 401 or mapid == 400) then 
mapname = " ß≠Íng m´n " 
ladder = 10133 
elseif (mapid == 403 or mapid == 402) then 
mapname = " n®m ÆÈc " 
ladder = 10134 
elseif (mapid == 405 or mapid == 404) then 
mapname = " Nga Mi " 
ladder = 10135 
elseif (mapid == 407 or mapid == 406) then 
mapname = " thÛy kh„i " 
ladder = 10136 
elseif (mapid == 409 or mapid == 408) then 
mapname = " C∏i Bang " 
ladder = 10137 
elseif (mapid == 411 or mapid == 410) then 
mapname = " ngµy nh…n " 
ladder = 10138 
elseif (mapid == 413 or mapid == 412) then 
mapname = " V‚ ß≠¨ng " 
ladder = 10139 
elseif (mapid == 415 or mapid == 414) then 
mapname = " C´n L´n " 
ladder = 10140 
end 
if (flag == 1) then 
return mapname 
elseif(flag == 2) then 
return ladder 
end 
end 
-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com - b∂ng x’p hπng ID muËn ÆÊi -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  

function validateDate(startt,endt) 
local now = tonumber(date("%y%m%d%H")) 
if(now >= startt and now < endt) then 
return 1 
end 
return nil 
end 

function AddAword(level, result) 
local awardpro = {} 
local fac = 1 

if ( level >= 50 and level <=59 ) then 
fac = 1 
elseif ( level >= 60 and level <= 69 ) then 
fac = 1.3 
elseif ( level >= 70 and level <= 79 ) then 
fac = 1.8 
elseif ( level >= 80 ) then 
fac = 3.8 
end 
	aword = (700 + ( level * 4 - 150 ) / 5 * 100 ) * result * fac
AddOwnExp(aword) 

if( result ~= 60 )then 
return 
end 
for i = 1, getn(CP_AWARD_ITEM) do 
awardpro[i] = CP_AWARD_ITEM[i][3] 
end 
numth = randByProbability(awardpro) 
if (getn(CP_AWARD_ITEM[numth][2]) == 6 ) then 
AddItem(CP_AWARD_ITEM[numth][2][1], CP_AWARD_ITEM[numth][2][2], CP_AWARD_ITEM[numth][2][3], CP_AWARD_ITEM[numth][2][4], CP_AWARD_ITEM[numth][2][5], CP_AWARD_ITEM[numth][2][6]) 
else 
AddEventItem(CP_AWARD_ITEM[numth][2][2]) 
end 
Msg2Player("Ng≠¨i Æπt Æ≠Óc mÈt "..CP_AWARD_ITEM[numth][1]) 
end 

function randByProbability(aryProbability) 
local nRandNum; 
local nSum = 0; 
local nArgCount = getn( aryProbability ); 
for i = 1, nArgCount do 
		nSum = nSum + aryProbability[i];
end 
	nRandNum = mod( random( nSum ) + random( 1009 ), nSum ) + 1;
for i = nArgCount, 1, -1 do 
nSum = nSum - aryProbability[i]; 
if( nRandNum > nSum ) then 
return i; 
end 
end 
end 


-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com TaskValue Æ›ch thao t∏c BEGIN-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com - 
-- script viet hoa By http://tranhba.com  thi’t tr› nhi÷m vÙ trπng th∏i 
function nt_settask(nTaskID, nTaskValue) 
SetTask(nTaskID, nTaskValue) 
SyncTaskValue(nTaskID) -- script viet hoa By http://tranhba.com  cÔng b≠Ìc Æ’n kh∏ch hµng b≠ng 
end 

-- script viet hoa By http://tranhba.com  l y Æ≠Óc nhi÷m vÙ trπng th∏i 
function nt_gettask(nTaskID) 
return GetTask(nTaskID) 
end 
-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com TaskValue Æ›ch thao t∏c END-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com - 

-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com Ini v®n ki÷n Æ›ch thao t∏c BEGIN-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com - 
function GetIniFileData(mapfile, sect, key) 
if (IniFile_Load(mapfile, mapfile) == 0) then 
print("Load IniFile Error!"..mapfile) 
return "" 
else 
return IniFile_GetData(mapfile, sect, key) 
end 
end 

function GetTabFileHeight(mapfile) 
if (TabFile_Load(mapfile, mapfile) == 0) then 
print("Load TabFileError!"..mapfile); 
return 0 
end 
return TabFile_GetRowCount(mapfile) - 1 
end; 

function GetTabFileData(mapfile, row, col) 
if (TabFile_Load(mapfile, mapfile) == 0) then 
print("Load TabFile Error!"..mapfile) 
return 0 
else 
		return tonumber(TabFile_GetCell(mapfile, row + 1, col))
end 
end 
-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com Ini v®n ki÷n Æ›ch thao t∏c END-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  

-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  v®n ki÷n Æ›ch thao t∏c BEGIN-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  
-- script viet hoa By http://tranhba.com  mÎ ra mÈt v®n ki÷n 
function biwu_loadfile(filename) 
if (IniFile_Load(filename, filename) == 0) then 
File_Create(filename) 
end 
end 

-- script viet hoa By http://tranhba.com  Æπt Æ≠Óc v®n ki÷n trung Æ›ch szSection Æ›ch key Æ›ch trﬁ gi∏ 
function biwu_getdata(filename, szsect, szkey) 
return IniFile_GetData(filename, szsect, szkey) 
end 

-- script viet hoa By http://tranhba.com  thi’t tr› v®n ki÷n trung Æ›ch szSection Æ›ch key trﬁ gi∏ lµ szValue 
function biwu_setdata(filename, szsect, szkey, szvalue) 
IniFile_SetData(filename, szsect, szkey, szvalue) 
end 

function biwu_save(filename) 
IniFile_Save(filename, filename) 
end 
-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  v®n ki÷n Æ›ch thao t∏c END-- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com -- script viet hoa By http://tranhba.com  


function Sort_Point(array) 
local orgindex = PlayerIndex 
local point_1 = 0 
local point_2 = 0 
local wincount_1 = 0 
local wincount_2 = 0 
local winrate_1 = 0 
local winrate_2 = 0 
for i = 1, getn(array) do 
for j = getn(array), 2, -1 do 
PlayerIndex = array[j] 
point_1 = nt_gettask(CP_TASKID_ROUND) 
wincount_1 = nt_gettask(CP_TASKID_WIN) 
if (point_1 == 0 or wincount_1 == 0) then 
winrate_1 = 0 
else 
winrate_1 = wincount_1/point_1 
end 

PlayerIndex = array[j - 1] 
point_2 = nt_gettask(CP_TASKID_ROUND) 
wincount_2 = nt_gettask(CP_TASKID_WIN) 
if (point_2 == 0 or wincount_2 == 0) then 
winrate_2 = 0 
else 
winrate_2 = wincount_2/point_2 
end 

if (winrate_1 > winrate_2) then 
a = array[j] 
array[j] = array[j - 1] 
array[j - 1] = a 
end 
end 
end 
PlayerIndex = orgindex 
return array 
end 


function WL_set_pl_state() 
LeaveTeam() -- script viet hoa By http://tranhba.com  rÍi Æi ÆÈi ngÚ 
SetCreateTeam(0); -- script viet hoa By http://tranhba.com  c m chÿ h‰p thµnh ÆÈi 
SetTaskTemp(200, 1) -- script viet hoa By http://tranhba.com  c m chÿ thay ÆÊi trÀn doanh 
SetLogoutRV(1); -- script viet hoa By http://tranhba.com  Æoπn tuy’n cÔng tˆ vong lµm mÈt c∏ sËng lπi Æi”m 
SetFightState(0) -- script viet hoa By http://tranhba.com  kh´ng ph∂i lµ trπng th∏i chi’n Æ u 
SetPKFlag(2) -- script viet hoa By http://tranhba.com  tru di÷t m´ th¯c 
ForbidChangePK(1); -- script viet hoa By http://tranhba.com  c m chÿ thay ÆÊi PK m´ th¯c 
SetPunish(0); -- script viet hoa By http://tranhba.com  v´ tˆ vong trıng phπt 
DisabledStall(1) -- script viet hoa By http://tranhba.com  c m chÿ bµy sπp 
ForbitTrade(1); -- script viet hoa By http://tranhba.com  c m chÿ giao dﬁch 
DisabledUseTownP(1) -- script viet hoa By http://tranhba.com  hπn ch’ k˙ Æang chu»n bﬁ tﬁch cÔng tranh tµi dÔng Æﬁa b™n trong sˆ dÙng trÎ v“ thµnh phÔ 
end 

function WL_clear_pl_state() 

camp = GetCamp(); 
SetCurCamp(camp); -- script viet hoa By http://tranhba.com  tπm thÍi trÀn doanh cÔng ch©n thÀt trÀn doanh nh t tr› 
SetCreateTeam(1); -- script viet hoa By http://tranhba.com  cho ph–p h‰p thµnh ÆÈi 
DisabledStall(0); -- script viet hoa By http://tranhba.com  cho ph–p bµy sπp 
SetTaskTemp(200, 0); -- script viet hoa By http://tranhba.com  cho ph–p thay ÆÊi bang ph∏i trÀn doanh 
SetFightState(0); -- script viet hoa By http://tranhba.com  Æ≠a v◊ kh´ng ph∂i lµ trπng th∏i chi’n Æ u 
SetPunish(1); -- script viet hoa By http://tranhba.com  c„ tˆ vong trıng phπt 
ForbidChangePK(0); -- script viet hoa By http://tranhba.com  cho ph–p sˆa ÆÊi chi’n Æ u m´ th¯c 
SetPKFlag(0); -- script viet hoa By http://tranhba.com  chi’n Æ u m´ th¯c Æ≠a v◊ luy÷n c´ng 
ForbitTrade(0); -- script viet hoa By http://tranhba.com  cho ph–p giao dﬁch 
SetDeathScript("");-- script viet hoa By http://tranhba.com  thi’t tr› tˆ vong ch©n vËn v◊ v´ ›ch 
RestoreOwnFeature(); 
end 


function OnCancel() 
end 
