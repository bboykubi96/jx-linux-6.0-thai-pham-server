Include("\\script\\tong\\tong_award_head.lua");
Include("\\script\\global\\signet_head.lua")

function main(nItemIndex) 
local nItemTime = GetItemParam(nItemIndex,1); 

if (signet_clude_use(nItemIndex) == 0) then 
return 1 
end 

if (GetWeeklyOffer() >= MAX_WEEK_CONTRIBUTION) then 
Say("Ng­¬i ®é cèng hiÕn ®¹t ®­îc ®· ®¹t chu th­îng h¹n , chØ cã thÓ gia t¨ng bang héi ®Ých x©y dùng c¬ kim cïng chiÕn bÞ c¬ kim . ng­¬i cã hay kh«ng muèn sö dông ®¹o nµy cô ? ", 
2, 
" sö dông /#signet_sure_use("..nItemIndex..")", 
" hñy bá /cancel") 
return 1 
end 
-- script viet hoa By http://tranhba.com  gia t¨ng ng­êi ®é cèng hiÕn cïng bang héi c¬ kim 
tongaward_fenglingdui() 
end 


function GetDesc(nItemIndex) 
local nYear = GetItemParam(nItemIndex, 2) 
local nMonth = GetItemParam(nItemIndex, 3) 
local nDate = GetItemParam(nItemIndex, 4) 

return " sö dông kú h¹n #<color=blue>"..nYear.." n¨m "..nMonth.." th¸ng "..nDate.." ngµy " 
end 

function PickUp( nItemIndex, nPlayerIndex ) 
local _, nTongID = GetTongName() 
if (nTongID > 0) then 
TONG_ApplyAddTaskValue(nTongID, TONGTSK_MONEYBOX_DROPMAX, 1) 
end 
return 1 
end 

function signet_sure_use(nItemIndex) 
if (signet_clude_use(nItemIndex) == 0) then 
return 0 
end 

if (RemoveItemByIndex(nItemIndex) == 1) then 
tongaward_fenglingdui() 
else 
print("Thñ tiªu thÝ ng­êi chi Ên sai lÇm thao t¸c #") 
end 
end 

function signet_clude_use(nItemIndex) 
local nParam1 = GetItemParam(nItemIndex, 1) 
local nCurTime = GetCurServerTime() -- script viet hoa By http://tranhba.com / gi©y 
local szItemName = GetItemName(nItemIndex) 
if (nCurTime >= nParam1) then 
Msg2Player(szItemName.." ®· h­ h¹i , kh«ng thÓ sö dông #") 
RemoveItemByIndex(nItemIndex) 
return 0 
end 
local _, nTongID = GetTongName() 

if (nTongID == 0) then 
Msg2Player("Ng­¬i kh«ng cã ë ®©y bang héi trung , kh«ng thÓ sö dông ®¹o nµy cô . ") 
return 0 
end 

if (TONGM_GetFigure(nTongID, GetName()) == TONG_RETIRE) then 
Msg2Player(" Èn sÜ kh«ng thÓ sö dông ®¹o nµy cô . ") 
return 0 
end 
return 1 
end
